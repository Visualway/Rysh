{% extends 'core/base.html' %}
{% load mention %}
{% load convert_markdown %}
{% load bulma_tags %}
{% block title %}
Dashboard - Develop
{% endblock title %}

{% block content %}

<div class="columns">
    <div class="column is-4 is-6-tablet-only">
        <div class="box badge-primary">
            <figure class="image is-128x128">
                <img src="{{ user.profile.get_image_url }}" alt="{{ user }}" class="is-rounded {{ user.profile.status }}">
            </figure>
            <br>
            <div id="devinfo">
                <h3 class="title is-3 has-text-weight-medium" id="name">
                    {{ user.devprofile.get_full_name }}
                </h3>
                <p class="subtitle has-text-weight-light">
                    <a href="{% url 'user_detail' user.username %}">
                        @{{ user.username }}
                    </a>
                </p>
                <p id="bio">
                <div id="bio_data">
                    {{ user.devprofile.bio | safe | mention | convert_markdown }}
                </div>
                </p>

                {% if user.devprofile.github_username %}
                <!-- Github -->
                <p>
                    <a href="https://github.com/{{ user.devprofile.github_username }}" target="_blank"
                        rel="noopener noreferrer">
                        <span class="icon">
                            üê±‚Äçüë§
                        </span>
                        <span>Github</span>
                    </a>
                </p>
                {% endif %}

                {% if user.devprofile.twitter_username %}

                <!-- Twitter -->
                <p>
                    <a href="https://twitter.com/{{ user.devprofile.twitter_username }}/" target="_blank"
                        rel="noopener noreferrer">
                        <span class="icon">
                            ü¶Ö
                        </span>
                        <span>Twitter</span>
                    </a>
                </p>
                {% endif %}

                {% if user.devprofile.website %}
                <p>
                    <a href="{{ user.devprofile.website }}" target="_blank" rel="noopener noreferrer">
                        <span class="icon">
                            üåé
                        </span>
                        <span>Website</span>
                    </a>
                </p>

                {% endif %}

                <br>
                <button class="button is-info is-fullwidth" id="editButton"
                    onclick="document.getElementById('devform').classList.toggle('is-hidden')">Edit</button>
            </div>
            <div id="devform" class="is-hidden">
                <form action="." method="post">

                    <div class="field">
                        <div class="control">
                            {% csrf_token %}
                            {{ form | bulma }}
                        </div>
                    </div>
                    <div class="field">
                        <div class="control">
                            <button class="button is-info is-fullwidth" id="save_profile">
                                Submit
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="box">
            <div class="level">
                <div class="level-left">
                    <h4 class="title is-6">
                        My Bots¬†ü§ñ
                    </h4>
                </div>
                <div class="level-right">
                    <button class="button is-small" onclick="$('#bot_form').toggleClass('is-active')">
                        Create New Bot
                    </button>
                </div>
            </div>
            <hr>
            {% for bot in user.owner.all %}
            <div class="media">
                <div class="media-left">
                    <figure class="image is-32x32">
                        <img src="{{ bot.user.profile.get_image_url }}" alt="{{ bot }}" class="is-rounded {{ bot.user.profile.status }}">
                    </figure>
                </div>
                <div class="media-content">
                    <p class="title is-5">
                        {{ bot.name }}
                    </p>
                </div>
                <div class="media-right">
                    <a href="{% url 'developer_bot_detail' bot.id %}" class="button is-primary ">
                        View
                    </a>
                </div>
            </div>
            {% endfor %}

        </div>
    </div>
    <div class="modal" id="bot_form">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="card">
                <div class="card-content">
                    <h1 class="title is-1">
                        Create A New Bot
                    </h1>
                    <form action="{% url 'developer_bot_create' %}" method="post">
                        {% csrf_token %}
                        {{ bot_form| bulma }}
                        <div class="field">
                            <div class="control">
                                <button class="button is-fullwidth">
                                    Create Bot
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <button class="modal-close is-large" aria-label="close"
            onclick="$('#bot_form').toggleClass('is-active')"></button>

    </div>
    <div class="column">
        <div class="box">
            <div class="level">
                <div class="level-left">
                    <h1 class="title has-text-weight-bold">API Keys</h1>
                </div>
                <div class="level-right">
                    <div class="buttons">
                        <a class="button is-info" href="{% url 'refresh_token' %}" id="refreshKey">Refresh Key¬†üîÉ</a>
                    </div>

                </div>
            </div>
            <!-- API Key -->
            <div class="field">
                <div class="control">
                    <div class="tags has-addons">
                        <span class="tag is-dark">API Key</span>
                        <span class="tag is-info" id="privateKey">{{ user.devprofile.token.token }}</span>
                    </div>
                </div>
            </div>
        </div>
        <br>
    </div>
</div>
{% endblock content %}